server {
        listen         80;
        server_name    bookmeter.org;
        return 301 https://$host$request_uri;
}

server {
        listen        443 http2 ssl;
        server_name   bookmeter.org;
        ssl_certificate /var/www/bookmeter.org/ssl/bookmeter.org.crt;
        ssl_certificate_key /var/www/bookmeter.org/ssl/bookmeter.org.key;
        server_name bookmeter.org;

        location /cdn/ {
                alias /var/www/cdn.bookmeter.org/;
                include includes/static-assets.conf;
        }

        location /public/ {
                root /var/www/bookmeter.org/current/dist;
                include includes/static-assets.conf;
        }

        location / {
                proxy_pass http://0.0.0.0:3000;
                proxy_http_version 1.1;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Host $http_host;
                proxy_set_header X-Real-IP $remote_addr;
        }
}
