{
  "apps" : [
    {
      "name" : "bookmeter.org",
      "script" : "dist/server.js",
      "instances" : "4",
      "exec_mode" : "cluster"
    }
  ],
  "deploy" : {
    "production" : {
      "user" : "web",
      "host" : ["192.168.1.105"],
      "ref"  : "origin/main",
      "repo" : "git@github.com:Mati365/bookmeter.org.git",
      "path" : "/var/www/bookmeter.org",
      "post-deploy" : "yarn install --production=false && yarn run build:production && ln -sf ../.env ./.env && yarn run migration:run && pm2 startOrRestart ecosystem.json --env production",
      "env": {
        "NODE_ENV": "production",
        "APP_ENV": "production"
      }
    }
  }
}
